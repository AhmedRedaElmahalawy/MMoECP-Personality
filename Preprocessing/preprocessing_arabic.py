# -*- coding: utf-8 -*-
"""preprocessing_arabic.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1-m1_opUy-V20_fCg7u-ng12zcvgU-m4a
"""

import re
import nltk
from nltk.corpus import stopwords
from nltk.tokenize import word_tokenize
from nltk.stem import ISRIStemmer
import string
import os
import shutil
# Make sure you download the necessary NLTK resources
nltk.download('punkt')
nltk.download('stopwords')

# Define the Arabic stopwords
arabic_stopwords = set(stopwords.words("arabic"))
Arabic_stopwords = {'ذين', 'ابدا', 'كلما', 'اطعم', 'تسعة', 'خال', 'ظ', 'امامك', 'ظن', 'ء', 'ثمة', 'على', 'بنا', 'اللتين', 'لسنا', 'ع', 'ماذا', 'هذِه', 'نحن', 'عشرة', 'كلاهما', 'اربعمئة', 'حذار', 'لكن', 'ريث', 'قبل', 'صبر', 'تارة', 'نعم', 'الالاء', 'وشكان', 'ذي', 'بي', 'حاي', 'اياهما', 'م', 'اكتوبر', 'مه', 'ثامن', 'جمعة', 'ذيت', 'الا', 'هذينِ', 'ذال', 'ال', 'خ', 'هاته', 'تحت', 'هؤلاء', 'لبيك', 'تينك', 'خمسمئة', 'امام', 'خاء', 'تسعين', 'ما افعله', 'اللتيا', 'كن', 'بس', 'عند', 'ثلاث', 'عليك', 'لولا', 'ى', 'ر', 'كلا', 'خلف', 'اوه', 'مائة', 'ذان', 'ذلكم', 'احدى', 'واذ', 'اذار', 'انبا', 'بعد', 'ل', 'افٍ', 'فمن', 'انقلب', 'انتِ', 'اب', 'اي', 'راى', 'فلس', 'ممن', 'جير', 'هن', 'سادس', 'اذا', 'حين', 'عل', 'صراحة', 'بله', 'مئتان', 'عل', 'ثلاثمائة', 'نيسان', 'كاين', 'تسع', 'ولو', 'ست', 'بخ', 'هؤلاء', 'امس', 'بماذا', 'صباح', 'مساء', 'ان', 'بك', 'رزق', 'والذين', 'ليرة', 'فاذا', 'س', 'بئس', 'جعل', 'ثاني', 'جانفي', 'افريل', 'قط', 'يناير', 'نيف', 'نون', 'دينار', 'اللذان', 'دال', 'ي', 'حسب', 'مكانكما', 'سبعمائة', 'ستين', 'سقى', 'ولكن', 'نفس', 'كاي', 'شتان', 'ثمنمئة', 'ومن', 'شبه', 'منذ', 'اه', 'اب', 'الا', 'كى', 'عوض', 'انتم', 'غالبا', 'اياكن', 'ها', 'هذه', 'نوفمبر', 'مثل', 'لا سيما', 'حيثما', 'بهن', 'فان', 'واو', 'اض', 'بيد', 'غادر', 'ثمان', 'لوما', 'طق', 'تلقاء', 'وهب', 'ذانك', 'كان', 'بس', 'سحقا', 'غين', 'كانما', 'اليكن', 'ايه', 'اعطى', 'بؤسا', 'اللذين', 'مافتئ', 'امد', 'لهم', 'ان', 'هنالك', 'عد', 'اقل', 'لسن', 'شتان', 'في', 'ذاك', 'ذلكن', 'ارى', 'ت', 'تجاه', 'استحال', 'لا', 'هما', 'لكم', 'ذه', 'اللاتي', 'ترك', 'فاء', 'اثنان', 'يا', 'حيث', 'ياء', 'اربع', 'لما', 'اوه', 'نبا', 'اما', 'تسعمئة', 'امسى', 'كخ', 'ايان', 'تحول', 'مايو', 'رجع', 'ورد', 'ذو', 'ايا', 'ذوا', 'اولئك', 'غداة', 'تينِ', 'فو', 'كاين', 'هكذا', 'هي', 'فيفري', 'ثالث', 'لك', 'مازال', 'ثلاثون', 'مما', 'نحو', 'ظل', 'هلا', 'راح', 'صه', 'ليسا', 'جميع', 'كاف', 'لستما', 'اللائي', 'خميس', 'كلا', 'ابريل', 'اما', 'ايه', 'والذي', 'اجمع', 'اياها', 'ستمائة', 'ته', 'ثم', 'اولالك', 'ساء', 'هاك', 'تاسع', 'ميم', 'اربعاء', 'سين', 'سبحان', 'ص', 'هم', 'ض', 'ط', 'احد', 'فبراير', 'دون', 'لنا', 'عاد', 'حرى', 'قاف', 'واها', 'كل', 'ثمانية', 'مكانكن', 'ثلاثاء', 'ب', 'ديسمبر', 'هج', 'مكانكم', 'حم', 'ستمئة', 'اياي', 'عشرون', 'لدن', 'هلا', 'ضحوة', 'لكنما', 'بها', 'اغسطس', 'اتخذ', 'طفق', 'اذن', 'غير', 'ايلول', 'سبعة', 'امين', 'عين', 'خاصة', 'خمسة', 'ج', 'حبيب', 'متى', 'تلك', 'وراءك', 'مهما', 'اي', 'هو', 'يوليو', 'ته', 'و', 'اهلا', 'عدا', 'هذانِ', 'اما', 'تموز', 'شيكل', 'تعلم', 'شرع', 'طاء', 'هل', 'بهم', 'الذي', 'صبرا', 'ف', 'ستون', 'تانِك', 'لهما', 'مارس', 'ا', 'جيم', 'اليكم', 'اها', 'بكما', 'ما برح', 'لي', 'الان', 'تفعلان', 'اثنا', 'التي', 'اخو', 'شتان', 'حادي', 'حمدا', 'ان', 'حي', 'اى', 'انا', 'اربعة', 'اسكن', 'ان', 'الف', 'انه', 'كيفما', 'بكن', 'لات', 'فضلا', 'لئن', 'هيا', 'حدث', 'هذين', 'انبرى', 'لكيلا', 'اجل', 'ح', 'اليكن', 'ليس', 'لكن', 'هذا', 'اليك', 'سرا', 'قد', 'ايها', 'ليسوا', 'لدى', 'يونيو', 'وا', 'جنيه', 'لم', 'هب', 'بين', 'يوان', 'سبت', 'هذان', 'الفى', 'انفا', 'هَيْهات', 'افعل به', 'ما', 'مرة', 'هاهنا', 'شباط', 'عاشر', 'مذ', 'خلافا', 'ؤ', 'انت', 'ة', 'ام', 'هللة', 'خبر', 'هلم', 'لها', 'معاذ', 'يورو', 'ليستا', 'اول', 'كذا', 'وهو', 'ذينك', 'اليك', 'امامك', 'وى', 'كسا', 'اقبل', 'بغتة', 'هاتي', 'ا', 'زعم', 'ثمانين', 'عما', 'غ', 'ضاد', 'وجد', 'اخذ', 'ذلكما', 'طاق', 'ابتدا', 'تلكم', 'اضحى', 'عيانا', 'ذين', 'تي', 'ذِه', 'ذواتا', 'تفعلون', 'يمين', 'حبذا', 'ذهب', 'درهم', 'سبعمئة', 'هاته', 'حقا', 'سبتمبر', 'خلا', 'اخبر', 'ق', 'بس', 'مادام', 'هاتين', 'ذانِ', 'ماي', 'عسى', 'هاتان', 'ه', 'رب', 'او', 'مع', 'كلما', 'دولار', 'سبعين', 'اها', 'لكما', 'ريال', 'سنتيم', 'اليكَ', 'عن', 'بضع', 'مئة', 'ثم', 'سوف', 'مكانك', 'غدا', 'اولاء', 'كرب', 'علق', 'هنا', 'ذا', 'اياكما', 'علم', 'تي', 'هاك', 'كي', 'اثنين', 'اناء', 'انى', 'بما', 'راء', 'ا'}
Arabic_stopword1 = { "،", "آض", "آمينَ", "آه", "آهاً", "آي", "أ", "أب", "أجل", "أجمع", "أخ", "أخذ", "أصبح", "أضحى", "أقبل", "أقل", "أكثر", "ألا", "أم", "أما", "أمامك", "أمامكَ", "أمسى", "أمّا", "أن", "أنا", "أنت", "أنتم", "أنتما", "أنتن","أنتِ", "أنشأ", "أنّى", "أو", "أوشك", "أولئك", "أولئكم", "أولاء", "أولالك", "أوّهْ", "أي", "أيا", "أين", "أينما", "أيّ", "إذ", "إذا", "إذاً", "إذما", "إلى", "إليكم", "إليكما", "إليكنّ", "إليكَ", "إلَيْكَ", "إلّا","إمّا", "إن", "إنّما", "إي", "إياك", "إياكم", "إياكما", "إياكن", "إيانا", "إياه", "إياها", "إياهم", "إياهما","إياهن", "إياي", "إيهٍ", "إِنَّ", "ا", "ابتدأ", "اثر", "اجل", "احد", "اخرى", "اخلولق", "اذا", "اربعة", "ارتدّ", "استحال", "اطار", "اعادة", "اعلنت", "اف", "اكثر", "اكد", "الألاء", "الألى", "الا", "الاخيرة", "الان", "الاول", "الاولى", "التى", "التي", "الثاني", "الثانية", "الذاتي", "الذى", "الذي", "الذين", "السابق", "الف", "اللائي", "اللاتي", "اللتان", "اللتيا", "اللتين", "اللذان", "اللذين", "اللواتي", "الماضي", "المقبل", "الوقت", "الى", "اليوم", "اما", "امام", "امس", "ان", "انبرى", "انقلب", "انه", "انها", "او", "اول", "اي", "ايار", "ايام","ايضا", "ب", "بات", "باسم", "بان", "بخٍ", "برس", "بسبب", "بسّ", "بشكل", "بضع", "بطآن", "بعد", "بعض", "بك", "بكم", "بكما", "بكن", "بل", "بلى", "بما", "بماذا", "بمن", "بن", "بنا", "به", "بها", "بي", "بيد", "بين", "بَسْ","بَلْهَ", "بِئْسَ", "تانِ", "تانِك", "تبدّل", "تجاه", "تحوّل", "تلقاء", "تلك", "تلكم", "تلكما", "تم", "تينك","تَيْنِ", "تِه", "تِي", "ثلاثة", "ثم", "ثمّ", "ثمّة", "ثُمَّ", "جعل", "جلل", "جميع", "جير", "حار", "حاشا","حاليا", "حاي", "حتى", "حرى", "حسب", "حم", "حوالى", "حول", "حيث", "حيثما", "حين", "حيَّ", "حَبَّذَا", "حَتَّى"}

# Example usage
proper_nouns = {"وائل", "وفاة", "وطن", "وجه", "ورقة", "وسام", "وردة", "وصية", "وجدان", "وعد", "واحدة", "وجد" ,"ورة", "وصف", "وجع", "وجودك","واسق","ودعتك", "واثقا","وثيقة", "وجد", "وصل", "وهب", "وقى", "وقف", "وقع", "ورث", "ولى", "واحد", "واثقة", "ورى", "ومضى", "ودائعه", "وددت", "وطني", "وقت", "وجهها","وزير","وعج","وحش","واحشاني","واضح", "واسع", "ودود", "واثق", "وافر", "وإذ", "وإياك", "واستغفر", "والتين", "والوطن", "وات", "والدتك", "والدك", "ود", "وثب", "وحدك","وسع", "واحشنى","واحشنا","واحشتني", "وادي", "وهران", "واشنطن", "وسيم", "وائل", "وسهلا", "ولادة", "وشك", "وفا", "وجوه", "وصلت", "وصيتي", "ودع","وسعت","وقته", "وحدي", "ووجدانى","واحدي","واجب","واجعين","واجعني","واجعاه", "واجعاني", "واجع", "واثقين","واتساب","واثقا","واتس", "وحى","وحوش","وحوشا","وجدت","وجز","وجعا","وجعاني","وجعتني","وجعك","وثب","وثخة","ولاعة","ولد","وقوع","وقت","وفاء","وضع","وصف","وصية","وشوش","وسطي","وساوس","ورقة","ورق","ورد","وحيدة","وحيد","وثوق","واقع","وزير","وش","وصيته","وصينا","وسطيه","ودينى","وراه","ودوهم","ودك","وداني","وودوهم","وداعا","واقف","واضحة","واضح","وارد","واخدني","واخد","واحشني","واجه","وهمي","ونيس","ونة","ولادى"}

# Function to remove "و" from the start of words unless it's part of a proper noun
def remove_prefix_waw_with_exceptions(text, proper_nouns):
    words = text.split()  # Split the text into words
    processed_words = []
    for word in words:
        # If the word starts with "و" but is not in the proper nouns list, remove the "و"
        if word.startswith("و") and word not in proper_nouns:
            processed_words.append(word[1:])  # Remove the "و"
        else:
            processed_words.append(word)  # Keep the word as is
    return " ".join(processed_words)


# Function to preprocess the text
def preprocess_text(sentence):
    # Replace underscores with spaces
    sentence = sentence.replace("_", " ")
    # Replace Arabic letters (أ, آ, إ) with (ا)
    sentence = re.sub(r'[أآإ]', 'ا', sentence)
    # Remove URLs
    sentence = re.sub(r'http\S+|www\S+', '', sentence)
    # Remove special characters and numbers
    sentence = re.sub(r'[^\w\s]', '', sentence)  # Remove punctuation
    sentence = re.sub(r'\d+', '', sentence)      # Remove digits
    sentence = re.sub(r'ـ+', '', sentence)  # Remove Kashida (ـ) used for stretching words
    # Replace any character repeated more than twice with a single character
    sentence = re.sub(r'(.)\1{2,}', r'\1', sentence)
    # Replace specific Arabic letters with their standard forms
    sentence = sentence.replace('گ', 'ك')  # Replace گ with ك
    sentence = sentence.replace('ۆ', 'و')  # Replace ۆ with و
    sentence = sentence.replace('ٱ', 'ا')  # Replace ٱ with ا
    sentence = sentence.replace('ﭑ', 'ا')  # Replace ﭑ with ا
    sentence = sentence.replace('ڈ', 'د')  # Replace ڈ with د
    sentence = sentence.replace('ﮧ', 'ه')  # Replace ﮧ with ه
    sentence = sentence.replace(' ﺂ', ' ا')  # Replace  ﺂ with ا
    sentence = sentence.replace('ﺂ', 'ا')  # Replace  ﺂ with ا
    sentence = sentence.replace('ڳ', 'كى')  # Replace  ڳ with كى
    sentence = sentence.replace('ڳ', 'كى')  # Replace  ڳ with كى
    # Tokenize the sentence into words
    words = sentence.split()  # Simple fallback tokenizer

    # Remove stopwords, non-Arabic words, and English words
    filtered_words = [
        word for word in words
        if word not in arabic_stopwords
        and len(word) > 1
        and word not in Arabic_stopwords
        and re.search(r'[\u0600-\u06FF]', word)  # Keep only Arabic words
        and not re.search(r'[a-zA-Z]', word)     # Exclude English words
    ]

    # print(filtered_words)

    # Join words into a sentence
    filtered_sentence = " ".join(filtered_words)
    # Replace multiple spaces with a single space
    filtered_sentence = re.sub(r'\s+', ' ', filtered_sentence).strip()
    return " ".join(filtered_words)


# Folder paths
input_folder_path = '/content/a'
output_folder_path = '/content/preprocessing'

# Ensure the output folder exists
os.makedirs(output_folder_path, exist_ok=True)

# Iterate through all files in the folder
for filename in os.listdir(input_folder_path):
    file_path = os.path.join(input_folder_path, filename)
    # Ensure it's a file (not a directory)
    if os.path.isfile(file_path):
        with open(file_path, 'r', encoding='utf-8') as file:
            sentence = file.read()  # Read the content of the file

        # Apply preprocessing
        processed_text = remove_prefix_waw_with_exceptions(sentence, proper_nouns)

        cleaned_sentence = preprocess_text(processed_text)

        processed_text = remove_prefix_waw_with_exceptions(cleaned_sentence, proper_nouns)

        # Save the preprocessed text with the same filename in the output folder
        output_path = os.path.join(output_folder_path, filename)
        with open(output_path, 'w', encoding='utf-8') as output_file:
            output_file.write(processed_text)

# print("Preprocessing complete. Preprocessed file saved at:", output_path)